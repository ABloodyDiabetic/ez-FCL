var freeaps_glucoseGetLast;(()=>{var e={5941:e=>{function a(e){return e.date||Date.parse(e.display_time)||Date.parse(e.dateString)}function o(e,a){a||(a=0);var o=Math.pow(10,a);return Math.round(e*o)/o}e.exports=function(e){var t=(e=e.filter((function(e){return e.glucose||e.sgv})).map((function(e){if(e.glucose=e.glucose||e.sgv,null!==e.glucose)return e}))).length;const r=e[0],l=a(r),u=a(r);var n=[],s=[],c=[],g=[];if(1==t)return{glucose:r.glucose,noise:0,delta:0,shortAvgDelta:0,longAvgDelta:0,date:u,dura_ISF_minutes:0,dura_ISF_average:r.glucose,slope05:0,slope15:0,slope40:0,dura_p:0,delta_pl:0,delta_pn:0,bg_acceleration:0,a_0:0,a_1:0,a_2:0,r_squ:0};for(var d=0,i=1;i<t;i++){if(void 0!==e[i]&&"cal"===e[i].type){d=i;break}if(void 0!==e[i]&&e[i].glucose>38&&e[i].device===r.device){const t=e[i],u=a(t);var _,h=0;if(void 0!==u&&void 0!==l?(_=Math.round((l-u)/6e4),h=(r.glucose-t.glucose)/_*5,console.error("then minutesAgo = "+_+" avgDelta = "+o(h,2))):console.error("Error: date field not found: cannot calculate avgDel"),g.push(h),0<_&&_<2.5)r.glucose=(r.glucose+t.glucose)/2;else if(2.5<_&&_<17.5)s.push(h),2.5<_&&_<7.5&&n.push(h);else{if(!(17.5<_&&_<42.5))break;c.push(h)}}}var p=0,v=0,f=0,M=0;s.length>0&&(v=s.reduce((function(e,a){return e+a}))/s.length),p=n.length>0?n.reduce((function(e,a){return e+a}))/n.length:v,c.length>0&&(f=c.reduce((function(e,a){return e+a}))/c.length),g.length>0&&(M=g[0],console.error("most actual available avgDelta = "+o(M,2)));var b=r.glucose,m=b,w=0,k=a(r);for(i=1;i<t;i++){const o=e[i],t=a(o);if(b=Math.min(b,o.glucose),(m=Math.max(m,o.glucose))-b>2||k-t>66e4||u-t>36e5)break;w=(u-(k=t))/6e4}r.glucose;var F=0,x=0,D=0,S=0,I=0,A=0;var q=r.glucose,y=r.glucose,G=0;for(i=1;i<t;i++){const o=e[i],t=a(o);if(Math.round((l-t)/6e4)-G>13)break;if(!(o.glucose>.95*y&&o.glucose<1.05*y))break;y=(q+=o.glucose)/(i+1),G=Math.round((l-t)/6e4)}F=1.05,x=1.15,D=1.4,q=0;var L,E,j=0,z=0,B=0,C=7.5;for(i=0;i<t;i++){if(L=i*z==j*j?0:(i*B-j*q)/(i*z-j*j),(E=(l-a(ae=e[i]))/6e4)>C&&7.5==C&&(F=5*-L,C=17.5),E>C&&17.5==C&&(x=5*-L,C=42.5),E>C&&42.5==C){D=5*-L;break}j+=E,z+=E*E,q+=ae.glucose,ae.glucose*ae.glucose,B+=ae.glucose*E}S=0,I=0,A=0;var H,J=0,K=0,N=0,O=0,P=0;if(t>3){var Q=0,R=0,T=0,U=0,V=0,W=0,X=0,Y=a(e[0]),Z=0,$=300,ee=50;for(i=0;i<t;i++){var ae,oe=(a(ae=e[i])-Y)/1e3/$;if(-oe*$>2820)break;if(oe<Z-1.5){(i<3||-oe*$<600)&&(S=-Z*$/60,I=0,A=0,J=0,K=0,N=0,O=0,P=0);break}Z=oe;var te=ae.glucose/ee;R+=oe,T+=Math.pow(oe,2),U+=Math.pow(oe,3),V+=Math.pow(oe,4),Q+=te,W+=oe*te,X+=Math.pow(oe,2)*te;var re=i+1,le=0,ue=0,ne=0,se=0;if(re>=4&&-oe*$>=600&&(le=V*(T*re-R*R)-U*(U*re-R*T)+T*(U*R-T*T),ue=X*(T*re-R*R)-W*(U*re-R*T)+Q*(U*R-T*T),ne=V*(W*re-Q*R)-U*(X*re-Q*T)+T*(X*R-W*T),se=V*(T*Q-R*W)-U*(U*Q-R*X)+T*(U*W-T*X)),0!=le){var ce=ue/le;L=ne/le;for(var ge=se/le,de=Q/re,ie=0,_e=0,he=0;he<=i;he++){var pe=e[he],ve=a(pe);ie+=Math.pow(pe.glucose/ee-de,2);var fe=(ve-Y)/1e3/$,Me=ce*Math.pow(fe,2)+L*fe+ge;_e+=Math.pow(pe.glucose/ee-Me,2)}var be=.64;if(0!=ie&&(be=1-_e/ie),re>3&&be>=K){K=be,S=-oe*$/60;I=-50*(ce*Math.pow(-1,2)-1*L),A=ee*(ce*Math.pow(1,2)+1*L),J=2*ce*ee,N=ge*ee,O=L*ee,P=ce*ee,ce*ee,L*ee,ge*ee}}}}return H="glucose: "+o(r.glucose,0)+", noise: 0 , delta: "+o(p,0)+", short_avgdelta:  "+o(v,2)+", long_avgdelta: "+o(f,2)+", cgmFlatMinutes: "+o(w,0)+", date: "+r.date+", dura_ISF_minutes: "+o(G,0)+", dura_ISF_average: "+o(y,2)+", slope05 : "+o(F,2)+", slope15: "+o(x,2)+", slope40: "+o(D,2)+", parabola_fit_correlation: "+o(K,4)+", parabola_fit_minutes: "+o(S,2)+", parabola_fit_last_delta: "+o(I,2)+", parabola_fit_next_delta: "+o(A,2)+", parabola_fit_a0: "+o(N,2)+", parabola_fit_a1: "+o(O,2)+", parabola_fit_a2: "+o(P,2)+", bg_acceleration: "+o(J,2),{glucose:Math.round(1e4*r.glucose)/1e4,noise:0,delta:Math.round(1e4*p)/1e4,short_avgdelta:Math.round(1e4*v)/1e4,long_avgdelta:Math.round(1e4*f)/1e4,avgdelta:Math.round(1e4*M)/1e4,cgmFlatMinutes:Math.round(1e4*w)/1e4,dura_ISF_minutes:Math.round(1e4*G)/1e4,dura_ISF_average:Math.round(1e4*y)/1e4,slope05:Math.round(1e4*F)/1e4,slope15:Math.round(1e4*x)/1e4,slope40:Math.round(1e4*D)/1e4,dura_p:Math.round(1e4*S)/1e4,delta_pl:Math.round(1e4*I)/1e4,delta_pn:Math.round(1e4*A)/1e4,bg_acceleration:J,r_squ:Math.round(1e4*K)/1e4,a_0:Math.round(1e4*N)/1e4,a_1:Math.round(1e4*O)/1e4,a_2:Math.round(1e4*P)/1e4,pp_debug:H,date:l,last_cal:d,device:r.device}}}},a={};var o=function o(t){var r=a[t];if(void 0!==r)return r.exports;var l=a[t]={exports:{}};return e[t](l,l.exports,o),l.exports}(5941);freeaps_glucoseGetLast=o})();
